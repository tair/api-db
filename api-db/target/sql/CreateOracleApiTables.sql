--
-- Copyright 2011 Carnegie Institution for Science. All rights reserved.
--
-- Generated by AndroMDA Poesys/DB cartridge: DO NOT EDIT DIRECTLY.
-- Template: SubsystemOracleSchemaTables.vsl

-- Oracle SQL schema for api subsystem

CREATE TABLE Partner (
  partnerId NUMBER(38) NOT NULL, -- generated by sequence  
  name VARCHAR2(500) NOT NULL,  
  logoUri VARCHAR2(200),  
  termOfServiceUri VARCHAR2(200),  
  CONSTRAINT PartnerPK PRIMARY KEY (partnerId)
);

CREATE TABLE SubscriptionTerm (
  partnerId NUMBER(38) NOT NULL,  
  period NUMBER(12)(8) NOT NULL,  
  price BINARY_DOUBLE(6, 2) NOT NULL,  
  groupDiscountPercentage BINARY_DOUBLE(6, 2) NOT NULL,  
  description VARCHAR2(200) NOT NULL,  
  CONSTRAINT SubscriptionTermPK PRIMARY KEY (partnerId, period)
);

CREATE TABLE PartnerPattern (
  partnerId NUMBER(38) NOT NULL,  
  sourceUri VARCHAR2(200) NOT NULL,  
  targetUri VARCHAR2(200) NOT NULL,  
  CONSTRAINT PartnerPatternPK PRIMARY KEY (partnerId, sourceUri)
);

CREATE TABLE SubscriptionDescription (
  partnerId NUMBER(38) NOT NULL,  
  header VARCHAR2(200) NOT NULL,  
  descriptionType VARCHAR2(200) NOT NULL,  
  CONSTRAINT SubscriptionDescriptionPK PRIMARY KEY (header, partnerId)
);

CREATE TABLE SubscriptionDescriptionItem (
  header VARCHAR2(200) NOT NULL,  
  partnerId NUMBER(38) NOT NULL,  
  itemNo NUMBER(38),  
  text VARCHAR2(2048) NOT NULL,  
  CONSTRAINT SubscriptionDescriptionItemPK PRIMARY KEY (header, itemNo, partnerId)
);

CREATE TABLE ApiKey (
  apiKeyId NUMBER(38) NOT NULL, -- generated by sequence  
  apiKey VARCHAR2(200) NOT NULL,  
  CONSTRAINT ApiKeyPK PRIMARY KEY (apiKeyId)
);

CREATE TABLE Login (
  partyId NUMBER(38) NOT NULL,  
  username VARCHAR2(200) NOT NULL,  
  password VARCHAR2(100) NOT NULL,  
  email VARCHAR2(200),  
  institution VARCHAR2(100),  
  userIdentifier VARCHAR2(100),  
  partnerId NUMBER(38) NOT NULL,  
  CONSTRAINT LoginPK PRIMARY KEY (partyId, username)
);

CREATE TABLE AccessType (
  accessTypeId NUMBER(38) NOT NULL, -- generated by sequence  
  name VARCHAR2(200) NOT NULL,  
  CONSTRAINT AccessTypePK PRIMARY KEY (accessTypeId)
);

CREATE TABLE UriPattern (
  uriPatternId NUMBER(38) NOT NULL, -- generated by sequence  
  pattern VARCHAR2(200) NOT NULL,  
  CONSTRAINT UriPatternPK PRIMARY KEY (uriPatternId)
);

CREATE TABLE AccessRule (
  accessTypeId NUMBER(38) NOT NULL,  
  uriPatternId NUMBER(38) NOT NULL,  
  partnerId NUMBER(38) NOT NULL,  
  CONSTRAINT AccessRulePK PRIMARY KEY (accessTypeId, partnerId, uriPatternId)
);

CREATE TABLE PageView (
  pageViewId NUMBER(38) NOT NULL, -- generated by sequence  
  pageViewDate TIMESTAMP WITH TIME ZONE NOT NULL,  
  uri VARCHAR2(250) NOT NULL,  
  ip VARCHAR2(200) NOT NULL,  
  sessionId VARCHAR2(250) NOT NULL,  
  partyId NUMBER(38),  
  CONSTRAINT PageViewPK PRIMARY KEY (pageViewId)
);

CREATE TABLE IpCount (
  partnerId NUMBER(38) NOT NULL,  
  ip VARCHAR2(200) NOT NULL,  
  count NUMBER(12) NOT NULL,  
  CONSTRAINT IpCountPK PRIMARY KEY (ip, partnerId)
);

CREATE TABLE LimitValue (
  partnerId NUMBER(38) NOT NULL,  
  value NUMBER(12) NOT NULL,  
  CONSTRAINT LimitValuePK PRIMARY KEY (partnerId, value)
);

CREATE TABLE Party (
  partyId NUMBER(38) NOT NULL, -- generated by sequence  
  name VARCHAR2(200) NOT NULL,  
  partyType VARCHAR2(200) NOT NULL,  
  CONSTRAINT PartyPK PRIMARY KEY (partyId)
);

CREATE TABLE Country (
  countryId NUMBER(38) NOT NULL, -- generated by sequence  
  name VARCHAR2(200) NOT NULL,  
  CONSTRAINT CountryPK PRIMARY KEY (countryId)
);

CREATE TABLE IpRange (
  partyId NUMBER(38) NOT NULL,  
  startIp VARCHAR2(200) NOT NULL,  
  endIp VARCHAR2(200) NOT NULL,  
  CONSTRAINT IpRangePK PRIMARY KEY (partyId, startIp)
);

CREATE TABLE ActivationCode (
  activationCodeId VARCHAR2(50) NOT NULL,  
  period NUMBER(12)(8) NOT NULL,  
  purchaseDate TIMESTAMP WITH TIME ZONE NOT NULL,  
  partnerId NUMBER(38) NOT NULL,  
  CONSTRAINT ActivationCodePK PRIMARY KEY (activationCodeId)
);

CREATE TABLE SubscriptionTransaction (
  partnerId NUMBER(38) NOT NULL,  
  partyId NUMBER(38) NOT NULL,  
  transactionNo NUMBER(38),  
  transactionDate TIMESTAMP WITH TIME ZONE NOT NULL,  
  startDate TIMESTAMP WITH TIME ZONE NOT NULL,  
  endDate TIMESTAMP WITH TIME ZONE NOT NULL,  
  transactionType VARCHAR2(50) NOT NULL,  
  activationCodeId VARCHAR2(50),  
  CONSTRAINT SubscriptionTransactionPK PRIMARY KEY (partnerId, partyId, transactionNo)
);

CREATE TABLE Subscription (
  partnerId NUMBER(38) NOT NULL,  
  partyId NUMBER(38) NOT NULL,  
  startDate TIMESTAMP WITH TIME ZONE NOT NULL,  
  endDate TIMESTAMP WITH TIME ZONE NOT NULL,  
  subscriptionId NUMBER(18) NOT NULL,  
  CONSTRAINT SubscriptionPK PRIMARY KEY (partnerId, partyId)
);

